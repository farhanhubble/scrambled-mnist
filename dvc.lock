schema: '2.0'
stages:
  download:
    cmd: python cli.py download
    deps:
    - path: cli.py
      hash: md5
      md5: 23b0cc5e7ee315d705b6c1b1c3ab1139
      size: 1988
    - path: download.py
      hash: md5
      md5: 0c788e391dbe4894b3b137246bc90ea8
      size: 819
    params:
      config.json:
        kaggle_mnist_handle: oddrationale/mnist-in-csv
        kaggle_mnist_test_file: mnist_test.csv
        kaggle_mnist_train_file: mnist_train.csv
        kaggle_token_file: ./.secrets/kaggle.json
    outs:
    - path: data/test/raw
      hash: md5
      md5: 3e6db7925e066617ce9b49d79795e422.dir
      size: 18303650
      nfiles: 1
    - path: data/train/raw
      hash: md5
      md5: db3fcf22ca5bc8e382bcc384a3310090.dir
      size: 109640201
      nfiles: 1
  convert:
    cmd: python cli.py convert
    deps:
    - path: cli.py
      hash: md5
      md5: 23b0cc5e7ee315d705b6c1b1c3ab1139
      size: 1988
    - path: convert.py
      hash: md5
      md5: ebad11d340680a65f667bb81da75897e
      size: 1212
    - path: data/test/raw
      hash: md5
      md5: 3e6db7925e066617ce9b49d79795e422.dir
      size: 18303650
      nfiles: 1
    - path: data/train/raw
      hash: md5
      md5: db3fcf22ca5bc8e382bcc384a3310090.dir
      size: 109640201
      nfiles: 1
    outs:
    - path: data/test/converted
      hash: md5
      md5: d4c8cb964a18b7bc45ed6e1862d4ff41.dir
      size: 2755182
      nfiles: 10000
    - path: data/train/converted
      hash: md5
      md5: d1bc4c2136fd04dc8f2083fd5581d695.dir
      size: 16503300
      nfiles: 60000
  augment:
    cmd: python cli.py augment
    deps:
    - path: augment.py
      hash: md5
      md5: 2ad88d1c4ca2b5ba326f7c4d0ca14b4f
      size: 2780
    - path: cli.py
      hash: md5
      md5: 23b0cc5e7ee315d705b6c1b1c3ab1139
      size: 1988
    - path: data/train/converted
      hash: md5
      md5: d1bc4c2136fd04dc8f2083fd5581d695.dir
      size: 16503300
      nfiles: 60000
    params:
      config.json:
        scramble_fraction: 0.1
        scrambled_copies: 1
        seed: 57005
    outs:
    - path: data/train/augmented
      hash: md5
      md5: 1b5edcb449a4fecb56bb428334806103.dir
      size: 18574922
      nfiles: 65996
  train:
    cmd: python cli.py train
    deps:
    - path: data/train/augmented
      hash: md5
      md5: 1b5edcb449a4fecb56bb428334806103.dir
      size: 18574922
      nfiles: 65996
    - path: dataloader.py
      hash: md5
      md5: 961162a06905e9fced2fec772c464fa5
      size: 904
    - path: hypers.json
      hash: md5
      md5: e7fe39e4129b646cbc0882e4d8bed5e0
      size: 75
    - path: network.py
      hash: md5
      md5: 397626903283aaffa3cc8a589c802cd0
      size: 762
    - path: train.py
      hash: md5
      md5: a7873115f2a2e84bcded63e8f6fffe81
      size: 1730
    outs:
    - path: saved_models/scrambled_mnist.pth
      hash: md5
      md5: b8acd9c27a52abd0c3ea61e4a4f8670e
      size: 1828584
  test:
    cmd: python cli.py test
    deps:
    - path: data/test/raw
      hash: md5
      md5: 3e6db7925e066617ce9b49d79795e422.dir
      size: 18303650
      nfiles: 1
    - path: dataloader.py
      hash: md5
      md5: 961162a06905e9fced2fec772c464fa5
      size: 904
    - path: network.py
      hash: md5
      md5: 397626903283aaffa3cc8a589c802cd0
      size: 762
    - path: saved_models/scrambled_mnist.pth
      hash: md5
      md5: b8acd9c27a52abd0c3ea61e4a4f8670e
      size: 1828584
    - path: test.py
      hash: md5
      md5: 305d50686a77e0ca5bffd265d6350b33
      size: 1840
  download_mnist_c:
    cmd: python cli.py download-mnist-c
    deps:
    - path: ext_tests/mnist_c/download.py
      hash: md5
      md5: 305cc71d4a63001a0f97a230b7775d19
      size: 1536
    params:
      config.json:
        tmp_dir: ./.tmp
    outs:
    - path: .tmp/mnist_c.zip
      hash: md5
      md5: 4b34b33045869ee6d424616cd3a65da3
      size: 246661575
    - path: .tmp/mnist_c_leftovers.zip
      hash: md5
      md5: c365e9c25addd5c24454b19ac7101070
      size: 329676575
  convert_mnist_c:
    cmd: python cli.py convert-mnist-c
    deps:
    - path: data/external/raw/mnist_c
      hash: md5
      md5: de2a622181ff51c44f1dadf5e10859ec.dir
      size: 887048192
      nfiles: 64
    - path: data/external/raw/mnist_c_leftovers
      hash: md5
      md5: 6256cd7051eb0a7bfc4f7ab06c80f589.dir
      size: 887048192
      nfiles: 64
    - path: ext_tests/mnist_c/convert.py
      hash: md5
      md5: 970f696981e7e645f211d491bf356149
      size: 2330
    outs:
    - path: data/external/converted/mnist_c
      hash: md5
      md5: e857288949b76f9c92c2b98cead4dc0f.dir
      size: 368735671
      nfiles: 1120000
    - path: data/external/converted/mnist_c_leftovers
      hash: md5
      md5: 7060db1982474888c356fb3e5748f687.dir
      size: 448158752
      nfiles: 1120000
  extract_mnist_c:
    cmd: python cli.py extract-mnist-c
    deps:
    - path: .tmp/mnist_c.zip
      hash: md5
      md5: 4b34b33045869ee6d424616cd3a65da3
      size: 246661575
    - path: .tmp/mnist_c_leftovers.zip
      hash: md5
      md5: c365e9c25addd5c24454b19ac7101070
      size: 329676575
    - path: ext_tests/mnist_c/extract.py
      hash: md5
      md5: 7fd6a8b2d8bb631efc4585bde1606a96
      size: 949
    params:
      config.json:
        external_data_subdir: external/raw
        tmp_dir: ./.tmp
    outs:
    - path: data/external/raw/mnist_c
      hash: md5
      md5: de2a622181ff51c44f1dadf5e10859ec.dir
      size: 887048192
      nfiles: 64
    - path: data/external/raw/mnist_c_leftovers
      hash: md5
      md5: 6256cd7051eb0a7bfc4f7ab06c80f589.dir
      size: 887048192
      nfiles: 64
  test_mnist_c:
    cmd: python cli.py test-mnist-c
    deps:
    - path: data/external/converted/mnist_c
      hash: md5
      md5: e857288949b76f9c92c2b98cead4dc0f.dir
      size: 368735671
      nfiles: 1120000
    - path: data/external/converted/mnist_c_leftovers
      hash: md5
      md5: 7060db1982474888c356fb3e5748f687.dir
      size: 448158752
      nfiles: 1120000
    - path: dataloader.py
      hash: md5
      md5: 961162a06905e9fced2fec772c464fa5
      size: 904
    - path: ext_tests/mnist_c/test.py
      hash: md5
      md5: a89275a3eaa8d0ed91fa84ada0cf1212
      size: 481
    - path: network.py
      hash: md5
      md5: 397626903283aaffa3cc8a589c802cd0
      size: 762
    - path: saved_models/scrambled_mnist.pth
      hash: md5
      md5: b8acd9c27a52abd0c3ea61e4a4f8670e
      size: 1828584
    - path: test.py
      hash: md5
      md5: 305d50686a77e0ca5bffd265d6350b33
      size: 1840
